---
description: Zensical setup, configuration, extensions, theme customization, and deployment workflows
globs: docs/**/*.md, zensical.toml, wrangler.toml, scripts/docs/**/*.py
alwaysApply: false
---
# Zensical Documentation Rules

REMINDER: Do not start the docs website/server unless explicitly told to do so.

## Tux Project Context

**Tux** is an all-in-one open source Discord bot built for the All Things Linux community, featuring a comprehensive suite of moderation, utility, and entertainment commands. This documentation guide is specifically tailored for documenting Tux's features, architecture, and usage patterns.

### Project Architecture

Tux follows a modern, modular Python architecture:

- **Core System**: Bot lifecycle, cog loading, permission system, command handling
- **Database Layer**: SQLModel-based ORM with PostgreSQL, comprehensive data models
- **Modular Commands**: Organized into categories (moderation, utility, fun, info, etc.)
- **Plugin System**: Extensible architecture for community features
- **Service Layer**: Specialized services (moderation, Sentry, hot reload, HTTP client)
- **UI Components**: Branded embeds, buttons, modals, and interactive views

### Key Documentation Areas

**For Users:**

- Command usage and syntax
- Feature explanations (XP system, starboard, temp VC, etc.)
- Configuration options
- Troubleshooting common issues

**For Admins:**

- Server setup and configuration
- Permission management
- Moderation workflows
- Performance monitoring

**For Self-Hosters:**

- Installation procedures
- Docker deployment
- Database configuration
- Security hardening

**For Developers:**

- Architecture deep-dives
- Contribution guidelines
- Plugin development
- Testing strategies

### Documentation Philosophy

- **User-First**: Address real user needs and pain points
- **Practical**: Include working code examples and configurations
- **Comprehensive**: Cover all features and edge cases
- **Maintainable**: Keep documentation current with code changes
- **Accessible**: Use clear language, avoid jargon, provide context

### Tux-Specific Patterns

When documenting Tux:

1. **Command Examples**: Always show both slash commands (`/command`) and prefix commands (`$command`)
2. **Permission Levels**: Reference the role-based permission system (admin, moderator, user)
3. **Configuration**: Link to relevant config options and environment variables
4. **Error Handling**: Document common error scenarios and solutions
5. **Database Impact**: Note when commands affect persistent data
6. **Branded Elements**: Reference Tux's custom emojis, colors, and UI patterns

## Active Extensions

### Core Python Markdown Extensions

- **abbr**: Add tooltips to text with `<abbr>` HTML tags (plain text only)
- **attr_list**: Custom HTML attributes/CSS classes (`{: .class-name }`)
- **admonition**: Call-out blocks (notes, warnings, tips) with customizable titles, made collapsible with pymdownx.details
- **def_list**: Description lists (`<dl>`, `<dt>`, `<dd>`) via Markdown syntax
- **footnotes**: Reference-style footnotes rendered below document content
- **md_in_html**: Parse Markdown inside HTML block elements with `markdown="1"` attribute
- **tables**: GitHub Flavored Markdown table syntax support
- **toc**: Auto-generates TOC from document headings with permalinks (`¶` anchor links on hover)

### PyMdown Extensions

- **pymdownx.snippets**: Embed content from external files with auto_append (abbreviations glossary)
- **pymdownx.highlight**: Advanced syntax highlighting with Pygments, auto_title, linenums, and line_spans
- **pymdownx.inlinehilite**: Syntax highlighting for inline code blocks
- **pymdownx.superfences**: Enhanced code fences with custom Mermaid diagram support
- **pymdownx.details**: Makes admonitions collapsible
- **pymdownx.smartsymbols**: Auto-convert symbols like `(c)`, `(r)`, fractions
- **pymdownx.magiclink**: Auto-link GitHub issues, commits, users with repo_url_shortener and user/repo config
- **pymdownx.emoji**: Convert `:emoji:` syntax to Twemoji SVG icons
- **pymdownx.keys**: Render keyboard shortcuts like `++ctrl+alt+del++`
- **pymdownx.tabbed**: Content tabs with alternate_style for better mobile behavior
- **pymdownx.escapeall**: Enhanced character escaping with hardbreak and nbsp options
- **pymdownx.caret**: Superscript with `^^text^^` syntax
- **pymdownx.mark**: Highlight text with `==text==` syntax
- **pymdownx.tilde**: Strikethrough with `~~text~~` syntax
- **pymdownx.tasklist**: Convert task lists to checkboxes
- **pymdownx.betterem**: Enhanced emphasis handling

## Zensical Built-in Features

Zensical provides built-in features (no plugins needed):

- **Search**: Built-in search functionality with highlighting
- **Tags**: Built-in tagging system for content organization
- **Navigation**: Explicit navigation configuration in `zensical.toml` nav array
- **Mermaid**: Diagram support via PyMdown superfences extension
- **Social Cards**: Automatic social media card generation
- **Code Highlighting**: Advanced syntax highlighting via PyMdown extensions
- **Admonitions**: Call-out blocks with collapsible support (via pymdownx.details)
- **Content Tabs**: Tabbed content sections (via pymdownx.tabbed)
- **Footnotes**: Reference-style footnotes
- **Tooltips**: Interactive tooltips for terms and definitions (via abbr extension)
- **Breadcrumbs**: Automatic breadcrumb navigation (via navigation.path feature)
- **Instant Navigation**: Fast page transitions without full reload

## Theme Configuration

- **Variant**: `modern` (Material Design-inspired theme)
- **Custom Directory**: `overrides` for theme customizations (MiniJinja templates)
- **Logo**: Custom logo in `assets/images/logo.png`
- **Favicon**: Custom favicon matching logo
- **Features**:
  - Content actions (edit, view)
  - Code annotations and copy buttons
  - Content tooltips
  - Navigation instant loading, prefetch, tracking
  - Navigation indexes, top, tabs, sections, path, footer
  - Table of contents following
  - Search highlight
- **Palette**: `slate` (dark) and `default` (light) schemes
- **Fonts**: Inter (text), JetBrains Mono (code)
- **Icons**: Material Design icons with FontAwesome support
- **Copyright**: Custom copyright footer

## Navigation Configuration

- **Explicit Navigation**: Navigation defined in `zensical.toml` `nav` array
- **No Wildcards**: All pages must be explicitly listed in navigation
- **Structure**: Hierarchical navigation structure matching directory layout

## Dependency Management

### Adding New Documentation Packages

To add new packages to the docs group in `pyproject.toml`:

1. **Edit pyproject.toml**: Add the package to the `[dependency-groups]` section:

   ```toml
   docs = [
       # existing packages...
       "new-package>=1.0.0",
   ]
   ```

2. **Install/Update dependencies**: Use uv to sync the new dependencies:

   ```bash
   uv sync --group docs
   # Or sync all groups
   uv sync
   ```

3. **Test the package**: Verify it works with your docs:

   ```bash
   uv run docs serve
   ```

4. **Update lockfile**: Commit the updated `uv.lock` file

### Common Documentation Package Sources

- **Markdown extensions**: `pymdownx-*` for enhanced markdown features
- **Zensical**: Check Zensical documentation for available features

## Development Workflow

- **Build**: `uv run zensical build` (used by Cloudflare Workers)
- **Serve**: `uv run zensical serve` on `localhost:8000` (default)
- **Overrides**: Custom templates in `overrides/` directory (MiniJinja syntax)

## Deployment Configuration

### Cloudflare Workers (Primary Deployment)

Documentation is deployed using Cloudflare Workers with the following configuration:

- **Config file**: `wrangler.toml`
- **Build command**: `uv run zensical build` (executed by GitHub Actions)
- **Production URL**: `https://tux.atl.dev` (custom domain)
- **Preview URLs**: Auto-generated `*.workers.dev` URLs for branches/PRs
- **Static assets**: Served from `site/` directory
- **Observability**: Enabled for monitoring and logs

### Zensical Configuration

- **Main config**: `zensical.toml` (comprehensive theme and extension setup)
- **Theme**: `modern` variant (Material Design-inspired)
- **Extensions**: Extensive Python Markdown and PyMdown extensions for rich formatting
- **Navigation**: Explicit navigation defined in `zensical.toml` `nav` array
- **Assets**: Custom stylesheets, JavaScript, and images in `content/assets/`
- **Includes**: Abbreviations file auto-appended via snippets extension

### Deployment Process

1. **Local development**: `uv run docs serve` for real-time preview
2. **Build**: `uv run docs build` generates static site to `site/` directory
3. **GitHub Actions**: Automatically builds and deploys on git push
4. **Production**: Deploys to `tux.atl.dev` when pushed to main branch
5. **Previews**: Branch/PR deployments get temporary URLs for review

## Conventional Commits

This project uses conventional commits for all changes. When working on documentation:

### Commit Format

```text
<type>[optional scope]: <description>

[optional body]

[optional footer]
```

### Documentation Commit Types

- **`docs`**: Documentation changes (adding/updating docs, README, etc.)

```bash
# Documentation updates
git commit -m "docs: update installation guide for new requirements"
```

### Commit Rules

- **Type**: Lowercase, from approved list (build, chore, ci, docs, feat, fix, perf, refactor, revert, style, test)
- **Scope**: Optional, use for docs changes (e.g., `docs(api)`, `docs(user-guide)`)
- **Subject**: Max 120 chars, no period at end, start with lowercase (never use sentence case, title case, or uppercase)
- **Body**: Optional detailed explanation (no line length limit, but include blank line before body if present)
- **Footer**: Optional for breaking changes (`BREAKING CHANGE:`) or issue references (blank line before footer if present)
- **Header**: Complete `<type>[scope]: <subject>` must be ≤120 characters
