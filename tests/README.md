# Tests

Clean, scalable test layout following the test pyramid.

## Structure

- `tests/unit/`: Fast, isolated unit tests. No network/DB. Use mocks/fakes as needed.
- `tests/integration/`: Multiple components together (DB, services, files). Slower.
- `tests/e2e/`: Full user journeys. Few, deterministic, and stable.
- `tests/fixtures/`: Shared fixtures; keep focused and explicit.

## Markers

- `@pytest.mark.unit`
- `@pytest.mark.integration`
- `@pytest.mark.e2e`

## Running

- Quick, no coverage:
  - `poetry run tux test quick`
- With coverage (default term):
  - `poetry run tux test run`
- Parallel:
  - `poetry run tux test parallel`
- HTML report:
  - `poetry run tux test html` then open `htmlcov/index.html`

## Codecov

- Coverage is reported via `coverage.xml` generated by pytest-cov.
- Repo root `codecov.yml` controls thresholds and comments.

## Guidance

- Prefer many unit tests, fewer integration, fewest E2E.
- Keep fixtures readable; prefer function scope unless expensive setup.
- Avoid over-mocking; include integration tests to cover real contracts.
- Quarantine and deflake flaky tests promptly.
